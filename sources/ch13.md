# üìñ Chapter 13: Network Policies
*Locked Corridors (Network Isolation)*

By default, the **Central Mall** has an "Open Door Policy." Every shop (Pod) can talk to every other shop. While this sounds friendly, it is a security nightmare. If a hacker takes over the "Juice Bar," they can walk straight into the "Main Cashier." We use **Network Policies** to lock the doors.

---

## üé≠ 13.1 Ingress vs. Egress

In the world of Locked Corridors, we look at which way the person is walking:

| Term | Mall Analogy | K8s Concept |
| :--- | :--- | :--- |
| **Ingress** | **The Front Door.** Who is allowed to enter your shop? | Traffic coming *into* the Pod. |
| **Egress** | **The Staff Exit.** Where are your workers allowed to go? | Traffic leaving *from* the Pod. |



---

## üé≠ 13.2 The "Default Deny" Strategy

The safest way to run a mall is to lock *every* door and then only unlock the ones you need. 

1. **Lock Everything:** Apply a policy that says "Nobody can talk to anyone."
2. **Whitelist:** Add specific rules like: "Only the Cashier can talk to the Bank."



---

## üõ†Ô∏è The Blueprint (CKAD Speed-Run)

### 1. The "Only My Friends" Rule
Imagine the `database` shop only wants to hear from the `backend` shop.

///yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-backend-to-db
spec:
  podSelector:
    matchLabels:
      app: database # This policy protects the database
  policyTypes:
  - Ingress
  ingress:
  - from:
    - podSelector:
        matchLabels:
          app: backend # Only Pods with this label can enter
    ports:
    - protocol: TCP
      port: 5432
///

### 2. The Namespace Wall
You can also lock doors based on which floor (Namespace) the person is coming from.
///yaml
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          floor: finance # Only people from the Finance floor allowed
///

---

## ‚ö†Ô∏è The "Gotcha" (Exam Tip)
In the CKAD, if you apply a Network Policy and everything stops working, it‚Äôs usually because you forgot to allow **DNS**. If the clerk can't talk to the Mall Directory (DNS), they can't find the address of the shop they are supposed to visit!

///bash
# Check if a policy is blocking your Pod
kubectl describe netpol <policy-name>
///

---

## üß∞ Study Toolbox

* üìÑ **Doc:** [Network Isolation and Troubleshooting](../docs/md-resources/troubleshooting-kubernetes.md#section-8-3)
* üñºÔ∏è **Comic:** [The Locked Corridor - Whitelisting Traffic](../comics/network-policies/01-locked-corridors/README.md)
* üß™ **Lab:** [LAB 06 ‚Äì Network Policies & Locked Corridors](../labs/services-and-networking/lab06-network-policies/README.md)
